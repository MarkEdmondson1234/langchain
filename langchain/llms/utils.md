The code you provided defines two classes, `OpenAIChat` and `CerebriumAI`, which are both wrappers around large language models. The `OpenAIChat` class requires the `openai` python package to be installed and the `OPENAI_API_KEY` environment variable to be set with your API key. The `CerebriumAI` class requires the `cerebrium` python package to be installed and the `CEREBRIUMAI_API_KEY` environment variable to be set with your API key. Both classes include various parameters such as `model_name`, `model_kwargs`, `max_retries`, `prefix_messages`, `streaming`, `allowed_special`, and `disallowed_special`. Both classes also include several methods such as `_default_params`, `build_extra`, and `validate_environment`, which are used to build and validate additional parameters passed to the model. The `get_num_tokens` method of the `OpenAIChat` class calculates the number of tokens in a given text using the `tiktoken` package. The `_call` method of the `CerebriumAI` class makes a call to the CerebriumAI endpoint using the `model_api_request` method from the `cerebrium` package.

The `enforce_stop_tokens` function takes a string `text` and a list of stop words `stop`, and returns the text up to the first occurrence of any of the stop words. It does this by splitting the text using a regular expression pattern that matches any of the stop words, and returning the first element of the resulting list.

